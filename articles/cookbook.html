<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>cookbook â€¢ porcelain</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="cookbook">
<meta property="og:description" content="porcelain">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">porcelain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/porcelain.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cookbook.html">cookbook</a>
    </li>
    <li>
      <a href="../articles/roxygen.html">roxygen</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/reside-ic/porcelain/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cookbook_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>cookbook</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/reside-ic/porcelain/blob/HEAD/vignettes/cookbook.Rmd" class="external-link"><code>vignettes/cookbook.Rmd</code></a></small>
      <div class="hidden name"><code>cookbook.Rmd</code></div>

    </div>

    
    
<p>In contrast with the descriptive approach in the main vignette (<code><a href="../articles/porcelain.html">vignette("porcelain")</a></code>), this vignette contains little recipes for exposing and testing different endpoint types. They are ordered roughly from simplest to most complicated, and are written as standalone examples (which makes them quite repetitive!)</p>
<p>Below, we do not use the package convention of wrapping each endpoint in a function. This is to make the examples a little shorter and to make the endpoints more directly callable. In a package, a wrapper function is needed to make the schema path point to the correct place, and to allow binding of state into the endpoint (see later examples).</p>
<p>The one piece of shared code is that we will use a common schema root</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schema_root</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/schema"</span>, package <span class="op">=</span> <span class="st">"porcelain"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="get-endpoint-inputs-as-query-parameters-returning-json">GET endpoint, inputs as query parameters, returning JSON<a class="anchor" aria-label="anchor" href="#get-endpoint-inputs-as-query-parameters-returning-json"></a>
</h3>
<p>This is the example from the main vignette, adding two numbers given as query parameters and returning a single number. Note that we need to use <code><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">jsonlite::unbox()</a></code> to indicate that the single number should be returned as a number and not a vector of length 1 (compare <code>jsonlite::toJSON(1)</code> and <code>jsonlite::toJSON(jsonlite::unbox(1))</code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">endpoint_add</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain_endpoint.html">porcelain_endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="st">"GET"</span>, <span class="st">"/"</span>, <span class="va">add</span>,</span>
<span>  <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_input_query.html">porcelain_input_query</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"numeric"</span>, b <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>  returning <span class="op">=</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_returning.html">porcelain_returning_json</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="va">schema_root</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">api</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain.html">porcelain</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>validate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="fu">handle</span><span class="op">(</span><span class="va">endpoint_add</span><span class="op">)</span></span></code></pre></div>
<p>Run the endpoint:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"/"</span>, query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`X-Porcelain-Validated`</span></span>
<span><span class="co">#&gt; [1] "true"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $body</span></span>
<span><span class="co">#&gt; [1] "{\"status\":\"success\",\"errors\":null,\"data\":3}"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-endpoint-inputs-as-path-and-query-parameters-returning-json">GET endpoint, inputs as path and query parameters, returning JSON<a class="anchor" aria-label="anchor" href="#get-endpoint-inputs-as-path-and-query-parameters-returning-json"></a>
</h2>
<p>Slightly more interesting return type, this time returning a numeric vector.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">distribution</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">distribution</span>,</span>
<span>         normal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>         uniform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>         exponential <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">endpoint_random</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain_endpoint.html">porcelain_endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="st">"GET"</span>, <span class="st">"/random/&lt;distribution&gt;"</span>, <span class="va">random</span>,</span>
<span>  <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_input_query.html">porcelain_input_query</a></span><span class="op">(</span>n <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>  returning <span class="op">=</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_returning.html">porcelain_returning_json</a></span><span class="op">(</span><span class="st">"numericVector"</span>, <span class="va">schema_root</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">api</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain.html">porcelain</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>validate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="fu">handle</span><span class="op">(</span><span class="va">endpoint_random</span><span class="op">)</span></span></code></pre></div>
<p>Run the endpoint:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"/random/normal"</span>, query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`X-Porcelain-Validated`</span></span>
<span><span class="co">#&gt; [1] "true"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $body</span></span>
<span><span class="co">#&gt; [1] "{\"status\":\"success\",\"errors\":null,\"data\":[-2.2332,0.0432,0.7023,-1.4296]}"</span></span>
<span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"/random/uniform"</span>, query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`X-Porcelain-Validated`</span></span>
<span><span class="co">#&gt; [1] "true"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $body</span></span>
<span><span class="co">#&gt; [1] "{\"status\":\"success\",\"errors\":null,\"data\":[0.5771,0.6683,0.0346,0.732]}"</span></span></code></pre></div>
<p>Note that the output here is <em>always a vector</em>, even in the corner cases of 1 and 0 elements returned:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"/random/normal"</span>, query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`X-Porcelain-Validated`</span></span>
<span><span class="co">#&gt; [1] "true"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $body</span></span>
<span><span class="co">#&gt; [1] "{\"status\":\"success\",\"errors\":null,\"data\":[0.6718]}"</span></span>
<span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"/random/normal"</span>, query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`X-Porcelain-Validated`</span></span>
<span><span class="co">#&gt; [1] "true"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $body</span></span>
<span><span class="co">#&gt; [1] "{\"status\":\"success\",\"errors\":null,\"data\":[]}"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="post-endpoint-inputs-as-json-returning-json">POST endpoint, inputs as JSON, returning JSON<a class="anchor" aria-label="anchor" href="#post-endpoint-inputs-as-json-returning-json"></a>
</h2>
<p>Here is one way that a complex statistical procedure (here, just <code>lm</code>) might be wrapped as an API endpoint. Weâ€™ll run a linear regression against vectors of data <code>x</code> and <code>y</code> and return a table of coefficients.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ x, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.50146 -0.07428  0.01949  0.13379  0.45431 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   0.2125     0.2274   0.935 0.377386    </span></span>
<span><span class="co">#&gt; x             2.0659     0.3694   5.593 0.000514 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2915 on 8 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7963, Adjusted R-squared:  0.7709 </span></span>
<span><span class="co">#&gt; F-statistic: 31.28 on 1 and 8 DF,  p-value: 0.0005144</span></span></code></pre></div>
<p>Weâ€™re interested in getting the table of coefficients, which we can extract like this:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt;              Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) 0.2124864  0.2273773 0.9345102 0.3773856851</span></span>
<span><span class="co">#&gt; x           2.0659101  0.3693711 5.5930469 0.0005144019</span></span></code></pre></div>
<p>and transform a little to turn the row names into a column of their own</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span>
<span><span class="va">lm_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">lm_coef</span><span class="op">)</span>, <span class="va">lm_coef</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">lm_coef</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>(the <code>broom</code> package provides a nice way of doing this sort of manipulation of these slightly opaque objects). There are many ways of serialising this sort of data; we will do it in the default way supported by <code>jsonlite</code>, representing the object as an array of objects, each of which is key/value pairs for each row:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">lm_coef</span>, pretty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [</span></span>
<span><span class="co">#&gt;   {</span></span>
<span><span class="co">#&gt;     "name": "(Intercept)",</span></span>
<span><span class="co">#&gt;     "Estimate": 0.2125,</span></span>
<span><span class="co">#&gt;     "Std. Error": 0.2274,</span></span>
<span><span class="co">#&gt;     "t value": 0.9345,</span></span>
<span><span class="co">#&gt;     "Pr(&gt;|t|)": 0.3774</span></span>
<span><span class="co">#&gt;   },</span></span>
<span><span class="co">#&gt;   {</span></span>
<span><span class="co">#&gt;     "name": "x",</span></span>
<span><span class="co">#&gt;     "Estimate": 2.0659,</span></span>
<span><span class="co">#&gt;     "Std. Error": 0.3694,</span></span>
<span><span class="co">#&gt;     "t value": 5.593,</span></span>
<span><span class="co">#&gt;     "Pr(&gt;|t|)": 0.0005</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; ]</span></span></code></pre></div>
<p>So we have our target function now:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">lm_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span>
<span>  <span class="va">lm_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">lm_coef</span><span class="op">)</span>, <span class="va">lm_coef</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">lm_coef</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">lm_coef</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that the target function must deserialise the json itself. This is so that arguments can be passed to <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::fromJSON</a></code> easily to control how deserialisation happens. We may support automatic deserialisation later as an argument to <code><a href="../reference/porcelain_input_body.html">porcelain::porcelain_input_body_json</a></code>.</p>
<p>The endpoint is not that much more involved than before though we have interesting inputs and outputs, with schemas required for both</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint_lm</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain_endpoint.html">porcelain_endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="st">"POST"</span>, <span class="st">"/lm"</span>, <span class="va">fit_lm</span>,</span>
<span>  <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_input_body.html">porcelain_input_body_json</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"lmInputs"</span>, <span class="va">schema_root</span><span class="op">)</span>,</span>
<span>  returning <span class="op">=</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_returning.html">porcelain_returning_json</a></span><span class="op">(</span><span class="st">"lmCoef"</span>, <span class="va">schema_root</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The input schema, <code>lmInputs.json</code> is</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">{</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>    <span class="dt">"$schema"</span><span class="fu">:</span> <span class="st">"http://json-schema.org/draft-04/schema#"</span><span class="fu">,</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="dt">"id"</span><span class="fu">:</span> <span class="st">"lmInputs"</span><span class="fu">,</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"array"</span><span class="fu">,</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="dt">"items"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>        <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"object"</span><span class="fu">,</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>        <span class="dt">"properties"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>            <span class="dt">"x"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">},</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>            <span class="dt">"y"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">}</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>        <span class="fu">},</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>        <span class="dt">"required"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"x"</span><span class="ot">,</span> <span class="st">"y"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>        <span class="dt">"additionalProperties"</span><span class="fu">:</span> <span class="kw">false</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="fu">}</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="fu">}</span></span></code></pre></div>
<p>while the response schema <code>lmCoef.json</code> is</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">{</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>    <span class="dt">"$schema"</span><span class="fu">:</span> <span class="st">"http://json-schema.org/draft-04/schema#"</span><span class="fu">,</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="dt">"id"</span><span class="fu">:</span> <span class="st">"lmCoef"</span><span class="fu">,</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"array"</span><span class="fu">,</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="dt">"items"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>        <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"object"</span><span class="fu">,</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>        <span class="dt">"properties"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>            <span class="dt">"name"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"string"</span><span class="fu">},</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>            <span class="dt">"Estimate"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">},</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>            <span class="dt">"Std. Error"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">},</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>            <span class="dt">"t value"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">},</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>            <span class="dt">"Pr(&gt;|t|)"</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">}</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>        <span class="fu">},</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>        <span class="dt">"required"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"name"</span><span class="ot">,</span> <span class="st">"Estimate"</span><span class="ot">,</span> <span class="st">"Std. Error"</span><span class="ot">,</span> <span class="st">"t value"</span><span class="ot">,</span> <span class="st">"Pr(&gt;|t|)"</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>        <span class="dt">"additionalProperties"</span><span class="fu">:</span> <span class="kw">false</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="fu">}</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="fu">}</span></span></code></pre></div>
<p>These are both fairly strict schemas using both <code>required</code> and <code>additionalProperties</code>. You might want to be more permissive, but we find that strictness here pays off later.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">api</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain.html">porcelain</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>validate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="fu">handle</span><span class="op">(</span><span class="va">endpoint_lm</span><span class="op">)</span></span></code></pre></div>
<p>To exercise the API endpoint we need to pass in our input JSON (not an R object).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">json</span></span>
<span><span class="co">#&gt; [{"x":0.3687,"y":0.8878},{"x":0.6705,"y":1.6103},{"x":0.8268,"y":2.1723},{"x":0.8125,"y":1.8529},{"x":0.0035,"y":0.2462},{"x":0.4104,"y":1.2145},{"x":0.4165,"y":1.1454},{"x":0.803,"y":1.5255},{"x":0.722,"y":2.1583},{"x":0.5935,"y":0.9371}]</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"POST"</span>, <span class="st">"/lm"</span>, body <span class="op">=</span> <span class="va">json</span>, content_type <span class="op">=</span> <span class="st">"application/json"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`X-Porcelain-Validated`</span></span>
<span><span class="co">#&gt; [1] "true"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $body</span></span>
<span><span class="co">#&gt; [1] "{\"status\":\"success\",\"errors\":null,\"data\":[{\"name\":\"(Intercept)\",\"Estimate\":0.2125,\"Std. Error\":0.2274,\"t value\":0.9345,\"Pr(&gt;|t|)\":0.3774},{\"name\":\"x\",\"Estimate\":2.0659,\"Std. Error\":0.3694,\"t value\":5.5933,\"Pr(&gt;|t|)\":0.0005}]}"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="post-endpoint-inputs-as-binary-returning-binary">POST endpoint, inputs as binary, returning binary<a class="anchor" aria-label="anchor" href="#post-endpoint-inputs-as-binary-returning-binary"></a>
</h2>
<p>(This example also shows off a few other features)</p>
<p>Handling binary inputs and outputs is supported, provided that you can deal with them in R. In this example weâ€™ll use Râ€™s serialisation format (rds; see <code><a href="https://rdrr.io/r/base/serialize.html" class="external-link">?serialize</a></code> and <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">?saveRDS</a></code>) as an example, but this approach would equally work with excel spreadsheets, zip files or any other non-text data that you work with.</p>
<p>In this example weâ€™ll take some serialised R data and create a png plot as output. Weâ€™ll start by writing our target function:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">binary_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">width</span> <span class="op">=</span> <span class="fl">400</span>, <span class="va">height</span> <span class="op">=</span> <span class="fl">400</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">unserialize</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".png"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="va">tmp</span>, width <span class="op">=</span> <span class="va">width</span>, height <span class="op">=</span> <span class="va">height</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>    finally <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readBin.html" class="external-link">readBin</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fu"><a href="https://rdrr.io/r/base/raw.html" class="external-link">raw</a></span><span class="op">(</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.info.html" class="external-link">file.size</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here, we use <code>unserialize</code> to convert the incoming binary data into something usable, plot to a temporary file (which we clean up later, using <code>on.exit</code>). Using <code>tryCatch(..., finally = dev.off())</code> ensures that even if the plotting fails, the device will be closed. Finally, <code>readBin</code> reads that temporary file in a raw vector.</p>
<p>So, for example (using <code>str</code> to limit what is printed to screen)</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">data</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu">binary_plot</span><span class="op">(</span><span class="va">bin</span><span class="op">)</span>, vec.len <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  raw [1:11396] 89 50 4e 47 0d 0a 1a 0a 00 00 ...</span></span></code></pre></div>
<p>Itâ€™s hard to tell this is a png, but the first few bytes give it away (the <a href="https://en.wikipedia.org/wiki/List_of_file_signatures" class="external-link">magic number</a> <code>89 50 4e 47 0d 0a 1a 0a</code> is used at the start of all png files).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint_plot</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain_endpoint.html">porcelain_endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="st">"POST"</span>, <span class="st">"/plot"</span>, <span class="va">binary_plot</span>,</span>
<span>  <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_input_body.html">porcelain_input_body_binary</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span>,</span>
<span>  returning <span class="op">=</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="fu"><a href="../reference/porcelain_returning.html">porcelain_returning_binary</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">api</span> <span class="op">&lt;-</span> <span class="fu">porcelain</span><span class="fu">::</span><span class="va"><a href="../reference/porcelain.html">porcelain</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>validate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="fu">handle</span><span class="op">(</span><span class="va">endpoint_plot</span><span class="op">)</span></span></code></pre></div>
<p>Making the request (again using <code>str</code> to prevent printing thousands of hex characters)</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">api</span><span class="op">$</span><span class="fu">request</span><span class="op">(</span><span class="st">"POST"</span>, <span class="st">"/plot"</span>, body <span class="op">=</span> <span class="va">bin</span>,</span>
<span>                 content_type <span class="op">=</span> <span class="st">"application/octet-stream"</span><span class="op">)</span>,</span>
<span>    vec.len <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ status : int 200</span></span>
<span><span class="co">#&gt;  $ headers:List of 2</span></span>
<span><span class="co">#&gt;   ..$ Content-Type         : chr "application/octet-stream"</span></span>
<span><span class="co">#&gt;   ..$ X-Porcelain-Validated: chr "true"</span></span>
<span><span class="co">#&gt;  $ body   : raw [1:11396] 89 50 4e 47 0d 0a 1a 0a 00 00 ...</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
